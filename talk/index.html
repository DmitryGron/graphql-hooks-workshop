<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' />
  <title>Big</title>
  <link href='big.css' rel='stylesheet' type='text/css' />
  <link href='highlight.css' rel='stylesheet' type='text/css' />
  <style>
    .new-shiny { background: #aaaaaa; }

    @-webkit-keyframes blinker {
      from { opacity: 1.0; }
      to { opacity: 0.5; }
    }

    .blink {
      -webkit-animation-name: blinker;
      -webkit-animation-iteration-count: infinite;
      -webkit-animation-timing-function: cubic-bezier(1.0,0,0,1.0);
      -webkit-animation-duration: 800ms;
    }
  </style>
  <script src='big.js'></script>
  <script src='highlight.js'></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>
<body class='dark'>
  <div class="title">
    <div style="height: 30%">
      graphql-<span class="bubblegum">hooks</span>
      <em><i><span class="blink">Workshop</span></i></em>
    </div>
    <div style="font-size: 0.2em">
      <span class="supersplit">@</span>...
    </div>
  </div>
  <div>
    <img src='./nearform.svg' width='100'>
  </div>
  <div>
    Graph<span class="bubblegum">QL</span> is a new language for interacting with <em>web servers</em>
  </div>
  <div>
    Graph<span class="bubblegum">QL</span> is a new way to <em>interact with REST endpoints</em>
  </div>
  <div>
    Graph<span class="bubblegum">QL</span> has a <em>rich ecosystem</em>
  </div>
  <div>
    Tons of <em>tooling</em>, modules, even graphical query editors
  </div>
  <div>
    You may be familiar with frameworks such as <em>Apollo</em> and <em>Relay</em>
  </div>
  <div>
    Introducing <em>graphql-hooks</em> for React!
  </div>
  <div>
    <u><em>Setup</em></u>
    <ul>
      <li>Node v10.16.0</li>
      <li>clone github repository<br />
      <code>git clone git@github.com:nearform/graphql-hooks-workshop.git</code></li>
    </ul>
  </div>
  <div><em>Part 1:</em> Hello World</div>
  <div>
    <ul>
      <li>Node.js</li>
      <li>Fastify</li>
      <li>React</li>
      <li>Graph<span class="bubblegum">QL</span></li>
    </ul>
  </div>
  <div>
    <u><em>Hello World</em></u>
    <ul>
      <li><code>cd graphql-hooks-workshop/exercises/part-1-hello-world/</code></li>
      <li><code>npm install</code></li>
      <li><code>npm run watch</code></li>
    </ul>
  </div>
  <div>
    <span class="bubblegum">http://localhost:3000</span>
  </div>
  <div>Any <span class="bubblegum">issues?</span></div>
  <div>
    Anatomy of <em><code>src/graphql.js</code></em>
    <ul>
      <li><span class="bubblegum">fastify-gql</span> module</li>
      <li>schema</li>
      <li>resolvers</li>
      <li>data</li>
    </ul>
  </div>
  <div><span class="bubblegum">graph</span><i>i</i><em>QL</em></div>
  <div>
  <span class="bubblegum">graph</span><i>i</i><em>QL</em>
    is an in-browser IDE for exploring Graph<span class="bubblegum">QL</span><br />
  </div>
  <div>
    <span class="bubblegum">
      http://localhost:3000/graphiql.html
    </span>
  </div>
  <div>
    <em>QUERY</em>
    <pre><code>
        {
          users {
            name
          }
        }
    </code></pre>
  </div>
  <div><em>Part 2:</em> Graph<span class="bubblegum">QL</span> Skeleton</div>
  <div><em>Goal 1:</em> Display List of 'users'</div>
  <div><em>Goal 2:</em> Create a new 'user'</div>
  <div>
    <u>Graph<span class="bubblegum">QL</span> Skeleton</u>
    <ul>
      <li><code>cd graphql-hooks-workshop/exercises/part-2-skeleton/</code></li>
      <li><code>npm install</code></li>
      <li><code>npm run watch</code></li>
    </ul>
  </div>
  <div><em>Create a new file</em> <code class=javascript><pre>src/app/pages/ListUsers.js</pre></code></div>
  <div>
    <em>
      <ul>
        <li>Import React and useState</li>
        <li>Export and define the 'ListUser' component function</li>
      </ul>
    </em>
    <pre><code class=javascript>
import React, { useState } from 'react'

export default function ListUsers ({ users, createUser }) {
  return &lt;div />
}
    </code></pre>
  </div>
  <div>
    <em>Initialize the state variables</em>
    <pre><code class=javascript>
const [name, setName] = useState('')
    </code></pre>
  </div>
  <div>
    <em>List the names in USERS</em>
    <pre><code class=javascript>
return (
  &lt;div>
    &lt;ul>
      {users.map((user, i) =>
        &lt;li key={i}>{user.name}&lt;/li>
      )}
    &lt;/ul>
  &lt;/div>
)
    </code></pre>
  </div>
  <div>
    <em>Add the input to create a new 'user'</em>
    <pre><code class=javascript>
return (
  &lt;div>
    &lt;ul>
      {users.map((user, i) =>
        &lt;li key={i}>{user.name}&lt;/li>
      )}
    &lt;/ul></span>
     &lt;label>Name:
      &lt;input
        type='text'
        onChange={e => setName(e.target.value)}
        value={name}
      />
    &lt;/label>
    &lt;button onClick={createNewUser}>Save&lt;/button>
  &lt;/div>
)
    </pre></code>
  </div>
  <div>
    <em>Make 'createNewUser' function</em>
    <pre><code class=javascript>
async function createNewUser() {
  await createUser({ name })
  setName('')
}
    </code></pre>
  </div>
  <div>
    <em><u>src/app/pages/ListUsers.js</u></em>
    <pre><code class=javascript>
import React, { useState } from 'react'

export default function ListUsers ({ users, createUser }) {

  const [name, setName] = useState('')

  async function createNewUser() {
    await createUser({ name })
    setName('')
  }

  return (
    &lt;div>
      &lt;ul>
        {users.map((user, i) =>
          &lt;li key={i}>{user.name}&lt;/li>
        )}
      &lt;/ul>
      &lt;label>Name:
        &lt;input
          type='text'
          onChange={e => setName(e.target.value)}
          value={name}
        />
      &lt;/label>
      &lt;button onClick={createNewUser}>Save&lt;/button>
    &lt;/div>
  )
}
    </code></pre>
  </div>
  <div><em>Modify existing file</em> <code class=javascript><pre>src/app/AppShell.js</pre></code></div>
  <div>
    <em>Include our new component:</em>
    <pre><code class=javascript>import ListUsers from './pages/ListUsers'</code></pre>
  </div>
  <div>
    <em>Create some temporary data:</em>
    <pre><code class=javascript>
const USERS = [
  { name: 'John' },
  { name: 'Sally' }
]
    </code></pre>
  </div>
  <div>
    <em>Add a method to create a 'user'</em>
    <pre><code class=javascript>
const createUser =
  user => USERS.push(user)
    </code></pre>
  </div>
  <div>
    <em>
      <ul>
        <li>Render the 'ListUsers' component</li>
        <li>Pass 'USERS' list to be displayed</li>
        <li>Pass 'createUser' method to child component</li>
      </ul>
    </em>
    <pre><code class=html>
&lt;h1>Users List&lt;/h1>
&lt;ListUsers
  users={USERS}
  createUser={createUser}
/>
    </code></pre>
  </div>
  <div>
    <em><u>Check your work</u></em>
    <ul>
      <li><code>npm run watch</code></li>
      <li><span class="bubblegum">http://localhost:3000</span></li>
    </ul>
  </div>
  <div>Any <span class="bubblegum">issues?</span></div>
  <div><em>Part 3:</em> graphql-hooks</div>
  <div><em>graphql-hooks</em> is a tiny hooks-first and super-fast Graph<span class="bubblegum">QL</span> client</div>
  <div>
    <u><em>graphql-hooks</em></u>
    <ul>
      <li><code>cd graphql-hooks-workshop/exercises/part-3-hooks/</code></li>
      <li><code>npm install</code></li>
      <li><code>npm run watch</code></li>
    </ul>
  </div>
  <div><code class=javascript><pre>npm install graphql-hooks --save</pre></code></div>
  <div><em>Modify file</em> <code class=javascript><pre>src/app/pages/ListUsers.js</pre></code></div>
  <div>
    <em>Import 'useQuery' from graphql-hooks</em>
    <pre><code class=javascript>import { useQuery } from 'graphql-hooks'</code></pre>
  </div>
  <div>
    <em>Define a new Query</em>
    <pre><code class=javascript>
const LIST_USERS_QUERY = `
  query ListUsersQuery {
    users {
      name
    }
  }
`
    </code></pre>
  </div>
  <div>
    <em>Let's execute the query</em>
    <pre><code class=javascript>
const { data = { users } } =
  useQuery(LIST_USERS_QUERY)
    </code></pre>
  </div>
  <div>
    <em>More details about the query</em>
    <pre><code class=javascript>
const {
  data = { users: [] },
  loading,
  error,
  refetch
} = useQuery(LIST_USERS_QUERY)
    </code></pre>
  </div>
  <div>
    <em>Also import 'useMutation' from graphql-hooks</em>
    <pre><code class=javascript>import { useQuery, useMutation } from 'graphql-hooks'</code></pre>
  </div>
  <div>
    <em>Define a new Mutation </em>
    <pre><code class=javascript>
const CREATE_USER_MUTATION = `
  mutation CreateUser($name: String!) {
    createUser(name: $name) {
      name
    }
  }
`
    </code></pre>
  </div>
  <div>
    <em>Assign the Mutation</em>
    <pre><code class=javascript>
const [createUser] =
  useMutation(CREATE_USER_MUTATION)
    </code></pre>
  </div>
  <div>
    <em>Update the 'createNewUser' function</em>
    <pre><code class=javascript>
async function createNewUser() {
  await createUser({
    variables: { name }
  })

  setName('')
  await refetchUsers()
}
    </code></pre>
  </div>
  <div>
    <em>Add error handling, data.users, and unique keys</em>
    <code><pre>
      if (loading) {
        return &lt;div>
          Loading...
        &lt;/div>
      }

      if (error) {
        return &lt;div>
          Error occured.
        &lt;/div>
      }

      if (data.users) {
        return (
          &lt;div>
            &lt;ul>
              {data.users.map((user, i) => &lt;li key={i}>
                {user.name}
              &lt;/li>)}
            &lt;/ul> ...
    </code></pre>
  </div>
  <div><em>Modify file</em> <code class=javascript><pre>src/client/js/app-shell.js</pre></code></div>
  <div>
    <em>Import 'GraphQLClient' and 'ClientContext' from graphql-hooks</em>
    <pre><code class=javascript>
import { GraphQLClient, ClientContext } from 'graphql-hooks'
    </code></pre>
  </div>
  <div>
    <em>Create a GraphQL client with a path</em>
    <pre><code class=javascript>
const client = new GraphQLClient({
    url: '/graphql'
  })
    </code></pre>
  </div>
  <div>
    <em>Wrap 'AppShell' in the 'ClientContext' provider</em>
    <pre><code class=javascript>
const App = (
    &lt;ClientContext.Provider value={client}>
      &lt;AppShell />
    &lt;/ClientContext.Provider>
  )
    </code></pre>
  </div>
  <div>
    <em>If you want... <br />update the title in... </em>
    <pre><code class=javascript>src/app/AppShell.js</code></pre>
    <em>with</em>
    <code class=javascript><pre>&lt;h1>GraphQL Hooks&lt;/h1></pre></code>
  </div>
  <div>
    <em><u>Check your work</u></em>
    <ul>
      <li><code>npm run watch</code></li>
      <li><span class="bubblegum">http://localhost:3000</span></li>
    </ul>
  </div>
  <div>Any <span class="bubblegum">issues?</span></div>
  <div><em>Part 4:</em> Caching</div>
  <div>
    <u><em>Caching</em></u>
    <ul>
      <li><code>cd graphql-hooks-workshop/exercises/part-4-caching/</code></li>
      <li><code>npm install</code></li>
      <li><code>npm run watch</code></li>
    </ul>
  </div>
  <div><em>Part 5:</em> Server Side Rendering</div>
  <div>
    <u><em>Server Side Rendering</em></u>
    <ul>
      <li><code>cd graphql-hooks-workshop/exercises/part-5-ssr/</code></li>
      <li><code>npm install</code></li>
      <li><code>npm run watch</code></li>
    </ul>
  </div>
  <div><em>Part 6:</em> Pagination</div>
  <div>
    <u><em>Pagination</em></u>
    <ul>
      <li><code>cd graphql-hooks-workshop/exercises/part-6-pagination/</code></li>
      <li><code>npm install</code></li>
      <li><code>npm run watch</code></li>
    </ul>
  </div>
  <div>
    <em>graphql-hooks</em> are <span class="bubblegum">awesome!</span>
  </div>
  <div class="title">
    <div style="height: 30%" class="bubblegum">
      Thanks
    </div>
    <div style="font-size: 0.2em">
      <em>@</em>...
    </div>
  </div>
  <div>
    <img src='./nearform.svg' width='100'>
  </div>
</body>
</html>
